# -*- coding: utf-8 -*-
from __future__ import print_function
class Patient:
    def __init__(self):
        print("Patient")
        
    def deal_patient(self, patient_csv):
        # 填补以及修正缺失、异常的值
        print('Total lines: %d' % len(patient_csv))
        for col in patient_csv.columns:
            print('column -> %s, type -> %s' % (col, patient_csv[col].dtype), *list(patient_csv[col].unique()))
        # Total lines: 211

        # [end_date]  Len: 211(116) 2011-09-05 23:30:00 2014-06-05 09:15:52.920000000 2013-05-16 08:48:56.047000000 nan 2011-07-04 14:40:46.267000000 2012-09-04 09:34:34.420000000 2014-01-07 13:41:20.233000000 2014-10-10 21:40:00 2012-05-18 16:04:33.127000000 2011-03-25 15:37:30.610000000 2011-03-06 10:08:00 2012-12-28 10:40:23.953000000 2013-10-31 08:09:13.937000000 2014-06-07 08:45:53.327000000 2014-05-24 15:26:52.297000000 2011-10-08 13:42:00 2011-05-29 20:00:00 2012-10-11 18:44:00 2012-04-12 23:30:00 2010-07-24 13:47:00 2010-11-11 13:31:53.313000000 2014-10-28 13:51:36.983000000 2013-04-25 16:35:12.877000000 2009-06-29 11:06:26.017000000 2012-03-06 11:13:03.767000000 2015-04-23 18:40:58.267000000 2014-02-15 13:30:08.703000000 2012-01-12 16:37:12.077000000 2011-07-12 13:05:25.827000000 2014-09-30 10:37:09.313000000 2010-04-30 16:21:57.780000000 2012-12-12 10:44:06.017000000 2011-09-29 16:23:24.377000000 2014-12-25 16:11:03.877000000 2010-06-26 14:51:14.860000000 2014-06-26 18:57:40.390000000 2011-01-12 13:38:49.483000000 2010-06-30 09:20:09.267000000 2010-03-19 15:07:18.483000000 2010-11-04 15:59:59.967000000 2010-12-02 09:25:03.483000000 2011-11-10 09:54:00 2013-10-04 14:24:28.843000000 2010-05-19 16:12:24.610000000 2010-08-08 08:52:00 2014-05-05 15:47:52.717000000 2011-01-22 16:41:29.733000000 2010-11-01 18:19:21.627000000 2010-11-09 13:59:00 2011-08-16 16:15:40.780000000 2012-06-15 17:21:48.343000000 2012-02-24 08:58:08.890000000 2014-09-03 10:08:07.313000000 2011-03-29 10:20:24.360000000 2014-09-09 09:35:27.093000000 2010-10-20 13:18:37.267000000 2010-12-13 13:01:19.890000000 2012-04-04 16:24:27.110000000 2013-01-02 13:24:53.453000000 2013-09-05 07:51:22.750000000 2012-11-30 15:25:35.733000000 2013-12-16 15:28:28.047000000 2014-07-23 15:34:04.767000000 2013-10-31 11:14:27.500000000 2013-03-26 17:42:40.703000000 2013-11-29 19:16:49.627000000 2015-01-02 15:22:33.063000000 2011-11-19 07:55:32.657000000 2012-08-15 12:56:09.890000000 2013-01-18 16:29:14 2012-12-21 10:32:57.140000000 2013-01-26 14:57:01.077000000 2013-11-29 10:02:19.967000000 2012-08-15 12:56:47.563000000 2011-10-01 12:10:00 2014-01-07 14:37:17.563000000 2011-11-12 14:33:23.030000000 2014-06-01 14:35:00 2012-03-17 14:07:54.077000000 2012-04-11 22:04:00 2012-01-04 10:21:27.377000000 2012-10-01 14:07:00 2013-07-23 16:33:37.733000000 2012-11-30 16:39:22.267000000 2013-01-09 17:19:03.907000000 2013-02-13 15:17:01.920000000 2013-09-16 13:53:33.267000000 2014-06-02 10:17:12.483000000 2015-03-21 14:37:56.983000000 2013-09-10 12:14:06.203000000 2013-10-04 14:25:42.093000000 2014-01-30 10:25:19.780000000 2013-05-15 15:02:53.453000000 2013-10-19 14:49:00 2014-06-09 15:47:38.110000000 2014-09-08 11:02:41.467000000 2014-02-25 09:26:40.203000000 2013-08-05 10:47:33 2013-09-12 10:24:00 2013-10-04 14:26:55.390000000 2013-03-09 18:52:56.843000000 2013-03-22 14:03:57 2014-11-25 09:40:18.767000000 2014-05-28 13:50:37.127000000 2013-12-04 16:18:17.593000000 2013-09-16 14:14:31.377000000 2013-11-26 14:44:09.483000000 2014-02-24 14:04:00 2015-02-26 11:03:46.420000000 2015-01-17 17:31:04.907000000 2014-07-08 10:32:06.077000000 2015-01-23 14:19:53.233000000 2015-01-02 15:22:42.547000000 2015-01-23 10:27:47.627000000 2015-01-23 10:30:01.593000000 2015-02-09 19:23:45.593000000 2014-11-06 14:12:13.407000000
        # (结束日期需要对比)

        # [in_diagnosis]  Len: 211(190) 糖尿病肾病 尿毒症 陈旧性心梗 陈旧性脑梗 慢性肾小球肾炎  尿毒症 梗阻性肾病 尿毒症 原发性高血压 多囊肾 尿毒症 糖尿病肾病 尿毒症 肾动脉狭窄 尿毒症 糖尿病肾病 尿毒症  高血压病 狼疮性肾炎  尿毒症 2型糖尿病  双侧髋关节置换术后 高血压肾病  尿毒症 高血压肾病 尿毒症 慢性肾小球肾炎  尿毒症  乙肝肝硬化 多囊肾，慢性肾功能衰竭，尿毒症 慢性肾小球肾炎 尿毒症 尿毒症 梗阻性肾病 尿毒症 糖尿病肾病 尿毒症 高血压病 痛风  冠心病 糖尿病肾病 尿毒症 高血压病 冠心病 梗阻性肾病  尿毒症  前列腺癌术后 慢性肾小球肾炎?尿毒症 糖尿病肾病，尿毒症 狼疮性肾炎  尿毒症 慢性肾功能不全 肺部感染 慢性肾脏病,慢性肾功能衰竭,尿毒症 慢性肾炎,慢性肾功能衰竭,尿毒症 慢性肾炎，慢性肾功能衰竭，尿毒症 慢性肾衰-尿毒症,DN 慢性肾衰竭-尿毒症,多囊肾 尿毒症 慢性肾小球肾炎 慢性肾小球肾炎,慢性肾功能衰竭,尿毒症 慢性肾炎 尿毒症 糖尿病肾病,尿毒症 nan 慢性肾炎 尿毒症 高血压 慢性肾小球肾炎,慢性肾功能衰竭,尿毒症,肾性高血压 慢性肾衰竭，2型糖尿病，高血压病（3级，极高危） 慢性肾炎，尿毒症 高血压病，尿毒症 糖尿病肾病,慢性肾功能衰竭,尿毒症 慢性肾炎,尿毒症 慢性肾脏病，慢性肾功能衰竭，尿毒症 慢性肾炎，慢性肾功能衰竭(CKD Ⅴ期) 肺出血肾炎综合症，慢性肾功能衰竭，尿毒症 慢性肾炎，慢性肾衰，尿毒症 慢性肾功能衰竭,尿毒症,梗阻性肾病，肾结石 冠心病，尿毒症 尿毒症，糖尿病肾病 糖尿病肾病，肾衰竭期，心功能衰竭 慢性肾功能衰竭，左心衰 糖尿病肾病，慢性肾功能衰竭，尿毒症 糖尿病肾病，肾衰竭期 尿毒症 糖尿病肾病 慢性肾功能衰竭，尿毒症，慢性淋巴细胞性白血病 良性肾小动脉硬化症，慢性肾功能衰竭，造影剂肾病 慢性肾衰竭（CKD V期），糖尿病肾病（V 期） 慢性肾衰竭（尿毒症期） 慢性肾脏病,尿毒症 慢性肾功能不全 尿毒症 慢性肾衰 尿毒症 肾性贫血 高血压病，良性肾小动脉硬化，慢性肾衰竭，尿毒症 慢性肾衰－尿毒症，慢性肾炎 IgA肾病，慢性肾功能衰竭，尿毒症 慢性肾脏病,肾病综合症 梗阻性肾病,慢性肾衰竭,尿毒症 慢性肾衰竭，糖尿病肾病 糖尿病肾病   慢性肾衰竭（CKD V期） 慢性肾脏病，慢性肾衰竭，尿毒症 慢性肾衰竭（CKD V期） 高血压肾病，慢性肾衰竭，尿毒症 慢性肾炎，慢性肾衰竭，尿毒症 CRF：DN? 慢性肾衰竭 慢性肾衰尿毒症 糖尿病肾病，高钾血症 慢肾衰－尿毒症，梗阻性肾病，双肾结石 糖尿病肾病，慢性肾功能衰竭 慢性肾衰-尿毒症,DKD.高血压肾病 慢性肾衰，DKD,高血压肾病。淋巴瘤肾病 慢性肾衰竭（CKDV期）2、糖尿病肾病 慢性肾功能衰竭（CKDV期）梗阻性肾病，肾结石 慢性肾炎,慢性肾衰竭，尿毒症 1、糖尿病肾病 2、慢性肾功能衰竭（尿毒症期） 慢性肾衰竭（尿毒症） 1、慢性肾功能衰竭（尿毒症）2、卵巢癌术后 3、丙型肝炎 1、慢性肾功能衰竭（尿毒症期）2、痛风性关节炎 3、高血压病 慢性肾衰竭 高血钾症  交界性逸搏心律 尿毒症,肝硬化 ARF,隐性梅毒 CKD 糖尿病肾病，慢性肾衰竭，CKD5期 慢性肾衰竭（CKD5期） 慢性肾衰竭 IgA肾病 慢性肾脏病,尿毒症,肾性贫血 糖尿病肾病 CKDV期 慢性肾脏病 CKDV期 梗阻性肾病，尿毒症 尿毒症,糖尿病肾病,2型糖尿病 慢性肾功能衰竭 1.慢性肾功能衰竭 2.高血压病3/2型糖尿病 慢性肾脏病（CKD V期） 慢性肾功能衰竭（尿毒症期）肾性贫血 肾性高血压 慢性肾脏病 慢性肾脏病(CKD5期) 糖尿病肾病 急性腹膜炎 1、慢性肾功能不全（尿毒症期）2、1型糖尿病 急性心衰,肾衰竭 慢肾衰－尿毒症，慢肾炎 肾衰竭 慢性肾脏病（CKD 5期） 慢性肾脏病( CKD5期)糖尿病肾病 慢性肾脏病（V期）高血压肾病？ 1.慢性肾功能衰竭 2.双肺炎症 1、慢性肾脏病（CKD 5期）2、脑出血 1、肾移植术后 2、慢性肾脏病（CKD 5期） 尿毒症 乙肝肝硬化 慢性肾脏病（CKD 5期） CAPD CKD5期 慢性肾脏病（CKD5期） 慢性肾脏病（CKD 5期），慢性肾小球肾炎 糖尿病肾病 慢性肾衰竭(CKD5期) 慢性肾脏病(CKD 5期)
        # (规整意义不大，Excel已作出总结)

        # [center_begin_date]  Len: 211(206) 2005-10-01 00:00:00 2004-07-24 00:00:00 2006-09-01 00:00:00 2003-06-11 00:00:00 2006-11-06 00:00:00 2006-11-15 00:00:00 2006-10-21 00:00:00 2007-05-16 00:00:00 2007-01-18 00:00:00 2004-02-24 00:00:00 2006-12-23 00:00:00 1998-11-18 00:00:00 1997-03-01 00:00:00 2005-07-05 00:00:00 2007-03-01 00:00:00 2001-01-12 00:00:00 2004-06-01 00:00:00 2006-09-18 00:00:00 2005-11-25 00:00:00 2001-08-15 00:00:00 2005-05-08 00:00:00 2004-03-10 00:00:00 2007-04-21 00:00:00 2007-01-29 00:00:00 2007-02-12 00:00:00 2007-05-28 00:00:00 2007-09-14 00:00:00 2007-11-26 00:00:00 2007-11-30 00:00:00 2008-01-16 00:00:00 2008-01-21 00:00:00 2008-01-22 00:00:00 2008-02-11 00:00:00 2006-12-01 00:00:00 2007-10-09 00:00:00 2008-04-19 00:00:00 2008-05-02 00:00:00 2008-06-11 00:00:00 2008-07-12 00:00:00 2008-08-12 00:00:00 2008-08-26 00:00:00 2008-04-11 00:00:00 2008-10-28 00:00:00 2008-10-29 00:00:00 2008-11-13 00:00:00 2008-12-05 00:00:00 2008-12-13 00:00:00 2008-12-17 00:00:00 2008-12-19 00:00:00 2008-12-24 00:00:00 2008-12-29 00:00:00 2009-01-04 00:00:00 2009-01-06 00:00:00 2009-01-08 00:00:00 2009-02-09 00:00:00 2009-02-19 00:00:00 2009-03-27 00:00:00 2009-06-16 00:00:00 2009-06-19 00:00:00 2009-07-22 00:00:00 2009-09-10 00:00:00 2009-09-22 00:00:00 2009-10-13 00:00:00 2009-10-28 00:00:00 2009-11-21 00:00:00 2009-11-23 00:00:00 2009-12-02 00:00:00 2006-03-09 00:00:00 2009-12-25 00:00:00 2009-12-22 00:00:00 2009-12-28 00:00:00 2009-12-30 00:00:00 2010-01-04 00:00:00 2010-01-08 00:00:00 2010-01-30 00:00:00 2010-02-03 00:00:00 2010-02-15 00:00:00 2010-03-02 00:00:00 2010-03-04 00:00:00 2010-03-29 00:00:00 2010-03-31 00:00:00 2010-04-09 00:00:00 2010-04-24 00:00:00 2010-04-28 00:00:00 2010-05-12 00:00:00 2010-06-03 00:00:00 2010-07-08 00:00:00 2010-07-12 00:00:00 2010-07-25 00:00:00 2011-10-01 00:00:00 2010-11-08 00:00:00 2011-11-09 00:00:00 2011-11-19 00:00:00 2010-09-23 00:00:00 2010-09-25 00:00:00 2010-10-02 00:00:00 2010-10-30 00:00:00 2010-11-19 00:00:00 2010-11-20 00:00:00 2010-11-30 00:00:00 2010-12-28 00:00:00 2010-12-29 00:00:00 2011-01-03 00:00:00 nan 2011-01-08 00:00:00 2011-01-24 00:00:00 2011-02-10 00:00:00 2011-02-14 00:00:00 2011-03-16 00:00:00 2011-03-31 00:00:00 2011-04-05 00:00:00 2011-04-07 00:00:00 2011-04-22 00:00:00 2011-04-27 00:00:00 2011-04-29 00:00:00 2005-05-10 00:00:00 2011-05-20 00:00:00 2011-05-25 00:00:00 2011-06-02 00:00:00 2011-06-14 00:00:00 2011-07-02 00:00:00 2011-07-16 00:00:00 2011-07-20 00:00:00 2011-07-26 00:00:00 2011-09-06 00:00:00 2011-09-16 00:00:00 2011-09-19 00:00:00 2011-11-28 00:00:00 2013-03-01 00:00:00 2011-12-20 00:00:00 2011-12-21 00:00:00 2011-12-26 00:00:00 2012-01-20 00:00:00 2012-01-21 00:00:00 2012-02-02 00:00:00 2012-02-20 00:00:00 2012-03-28 00:00:00 2012-04-19 00:00:00 2012-05-07 00:00:00 2012-05-11 00:00:00 2012-05-17 00:00:00 2012-05-24 00:00:00 2012-07-26 00:00:00 2012-08-17 00:00:00 2012-08-24 00:00:00 2012-08-27 00:00:00 2012-06-08 00:00:00 2012-06-16 00:00:00 2012-08-31 00:00:00 2012-09-27 00:00:00 2012-10-17 00:00:00 2012-10-18 00:00:00 2012-06-25 00:00:00 2012-11-26 00:00:00 2012-12-24 00:00:00 2012-12-27 00:00:00 2012-10-09 00:00:00 2013-02-04 00:00:00 2013-02-22 00:00:00 2013-02-25 00:00:00 2013-02-26 00:00:00 2013-03-13 00:00:00 2012-09-01 00:00:00 2013-02-23 00:00:00 2014-05-16 00:00:00 2013-03-11 00:00:00 2013-03-27 00:00:00 2013-04-12 00:00:00 2013-04-15 00:00:00 2013-04-25 00:00:00 2013-05-15 00:00:00 2013-01-09 00:00:00 2013-07-24 00:00:00 2013-08-22 00:00:00 2012-10-13 00:00:00 2012-11-09 00:00:00 2013-02-05 00:00:00 2013-07-06 00:00:00 2013-09-03 00:00:00 2013-09-18 00:00:00 2013-08-21 00:00:00 2013-09-30 00:00:00 2013-10-25 00:00:00 2014-01-08 00:00:00 2014-01-17 00:00:00 2014-01-28 00:00:00 2014-02-17 00:00:00 2013-11-04 00:00:00 2013-11-26 00:00:00 2014-04-09 00:00:00 2014-04-23 00:00:00 2013-12-20 00:00:00 2014-02-08 00:00:00 2014-03-18 00:00:00 2014-05-10 00:00:00 2014-03-11 00:00:00 2014-06-25 00:00:00 2014-07-02 00:00:00 2014-08-01 00:00:00 2014-05-19 00:00:00 2014-08-21 00:00:00 2013-12-04 00:00:00 2014-05-12 00:00:00 2014-03-19 00:00:00 2015-05-07 00:00:00
        # [tx_begin_date]  Len: 211(202) 2005-10-01 00:00:00 2004-07-24 00:00:00 2006-09-01 00:00:00 2003-06-11 00:00:00 2006-09-02 00:00:00 2006-11-15 00:00:00 2006-10-21 00:00:00 2006-10-05 00:00:00 2007-01-18 00:00:00 2004-02-24 00:00:00 2006-12-23 00:00:00 1998-11-18 00:00:00 1997-03-01 00:00:00 2005-07-05 00:00:00 2007-03-01 00:00:00 2001-01-12 00:00:00 2004-03-01 00:00:00 2006-09-18 00:00:00 2005-04-01 00:00:00 2001-08-15 00:00:00 2005-05-08 00:00:00 2006-11-06 00:00:00 2004-03-10 00:00:00 2007-04-21 00:00:00 2007-01-29 00:00:00 2007-02-12 00:00:00 2007-05-28 00:00:00 2007-09-14 00:00:00 2007-11-26 00:00:00 2007-11-30 00:00:00 2008-01-16 00:00:00 2008-01-21 00:00:00 2008-01-22 00:00:00 2008-02-11 00:00:00 2006-12-01 00:00:00 2007-10-09 00:00:00 2008-04-19 00:00:00 2008-03-12 00:00:00 2005-12-11 00:00:00 2008-06-10 00:00:00 2008-08-12 00:00:00 2008-07-04 00:00:00 2008-04-11 00:00:00 2008-10-28 00:00:00 2008-10-29 00:00:00 2008-11-01 00:00:00 2008-12-05 00:00:00 2008-12-13 00:00:00 2008-12-17 00:00:00 2008-12-19 00:00:00 2008-12-24 00:00:00 2008-12-29 00:00:00 2009-01-04 00:00:00 2009-01-06 00:00:00 2009-01-08 00:00:00 2009-02-09 00:00:00 2009-02-19 00:00:00 2009-03-27 00:00:00 2009-06-16 00:00:00 2009-06-19 00:00:00 2009-02-01 00:00:00 2009-09-10 00:00:00 2009-09-22 00:00:00 2008-01-01 00:00:00 2009-10-28 00:00:00 2009-10-15 00:00:00 2009-11-23 00:00:00 2009-12-02 00:00:00 2009-03-09 00:00:00 2009-12-25 00:00:00 2009-12-22 00:00:00 2009-12-28 00:00:00 2009-12-30 00:00:00 2010-01-04 00:00:00 2010-01-08 00:00:00 2010-01-30 00:00:00 2010-02-03 00:00:00 2010-02-10 00:00:00 2010-03-02 00:00:00 2010-03-04 00:00:00 2010-03-29 00:00:00 2010-03-31 00:00:00 2010-04-09 00:00:00 2010-04-24 00:00:00 2010-04-28 00:00:00 2010-05-12 00:00:00 2010-06-03 00:00:00 2010-06-14 00:00:00 2010-07-12 00:00:00 2010-07-25 00:00:00 2011-08-18 00:00:00 2011-06-20 00:00:00 2011-11-09 00:00:00 2011-11-19 00:00:00 2009-04-08 00:00:00 2010-09-25 00:00:00 2010-10-02 00:00:00 2010-10-15 00:00:00 2010-11-19 00:00:00 2010-11-20 00:00:00 2010-11-30 00:00:00 2010-12-28 00:00:00 2010-06-10 00:00:00 2010-12-03 00:00:00 2011-01-05 00:00:00 2011-01-08 00:00:00 2011-01-24 00:00:00 2011-02-10 00:00:00 2011-02-14 00:00:00 2100-03-02 00:00:00 2011-03-31 00:00:00 2011-04-05 00:00:00 2011-04-07 00:00:00 2011-04-13 00:00:00 2011-04-22 00:00:00 2011-04-27 00:00:00 2011-04-29 00:00:00 2005-05-10 00:00:00 2011-05-20 00:00:00 2011-05-25 00:00:00 2011-06-02 00:00:00 2011-06-14 00:00:00 2009-12-13 00:00:00 2009-05-25 00:00:00 2008-08-01 00:00:00 2011-07-26 00:00:00 2011-09-06 00:00:00 nan 2011-09-19 00:00:00 2011-11-28 00:00:00 2013-03-01 00:00:00 2011-12-01 00:00:00 2011-12-26 00:00:00 2012-01-20 00:00:00 2012-01-21 00:00:00 2012-02-02 00:00:00 2012-02-03 00:00:00 2012-02-20 00:00:00 2012-03-28 00:00:00 2012-04-18 00:00:00 2012-05-07 00:00:00 2012-05-11 00:00:00 2012-05-24 00:00:00 2012-07-26 00:00:00 2012-08-17 00:00:00 2012-08-24 00:00:00 2012-08-27 00:00:00 2012-06-08 00:00:00 2012-06-06 00:00:00 2012-08-31 00:00:00 2012-09-27 00:00:00 2012-10-17 00:00:00 2012-10-18 00:00:00 2012-06-25 00:00:00 2012-11-26 00:00:00 2012-12-24 00:00:00 2009-05-10 00:00:00 2012-04-23 00:00:00 2013-02-04 00:00:00 2012-12-01 00:00:00 2013-02-16 00:00:00 2013-02-26 00:00:00 2013-03-13 00:00:00 2012-01-01 00:00:00 2013-02-23 00:00:00 2014-05-16 00:00:00 2013-04-12 00:00:00 2013-04-15 00:00:00 2013-04-25 00:00:00 2013-05-15 00:00:00 2013-01-09 00:00:00 2013-07-24 00:00:00 2013-08-22 00:00:00 2012-10-02 00:00:00 2012-11-09 00:00:00 2013-12-20 00:00:00 2013-07-06 00:00:00 2011-07-12 00:00:00 2013-09-18 00:00:00 2013-09-30 00:00:00 2006-03-01 00:00:00 2014-01-08 00:00:00 2014-01-17 00:00:00 2014-01-28 00:00:00 2014-02-17 00:00:00 2013-11-26 00:00:00 2014-04-09 00:00:00 2014-04-23 00:00:00 2014-02-08 00:00:00 2014-03-18 00:00:00 2014-05-10 00:00:00 2014-03-11 00:00:00 2014-03-25 00:00:00 2014-07-02 00:00:00 2014-08-01 00:00:00 2014-05-19 00:00:00 2014-05-20 00:00:00 2013-12-04 00:00:00 2014-05-12 00:00:00 2014-03-19 00:00:00 2015-05-07 00:00:00

        # [vascular_access_type]  Len: 211(199) 内瘘 右侧颈内静脉插管 左颈内 左股内 右侧股静脉置管 右颈内 右侧股静脉插管 右股静脉 右颈内静脉 直穿 动静脉内瘘 瘘管 左侧人造血管 颈内 颈内静脉插管 右颈内静脉插管 颈内静脉 右颈内静脉长期留置管 右股静脉穿刺插管 左前臂内瘘 左上肢动静脉内瘘 左股静脉插管 右侧颈内静脉 左颈内静脉 右股静脉插管 右颈内静脉置管 nan 右侧颈内静脉置管 左侧股静脉插管 左动静脉内瘘 直接穿刺 右股静脉置管 左 左前内瘘 左A-V瘘 左前臂A-V瘘 右侧内瘘 左侧内瘘 左前臂动静脉内瘘 颈内静脉长期导管 右侧颈内静脉导管 左头-桡动静脉内瘘 左内瘘 右颈内静脉临时中心静脉导管 左手头-桡动静脉内瘘 右侧颈内 左前臂动静脉瘘 右颈静脉临时管 右颈内静脉临时管 右股静脉临时中心静脉导管 右颈内静脉临时血液透析管
        # (规整意义不大，Excel已作出总结)

        # [vascular_access_build_date]  Len: 211(174) 2006-01-01 00:00:00 2004-06-01 00:00:00 2006-09-01 00:00:00 2003-08-01 00:00:00 2006-10-01 00:00:00 2006-03-01 00:00:00 2006-10-31 00:00:00 2006-10-16 00:00:00 2007-01-16 00:00:00 2004-03-01 00:00:00 2007-01-01 00:00:00 1998-11-01 00:00:00 1997-02-01 00:00:00 2005-05-01 00:00:00 2001-01-01 00:00:00 2004-02-01 00:00:00 nan 2005-04-01 00:00:00 2001-07-01 00:00:00 2006-11-14 00:00:00 2006-04-01 00:00:00 2007-02-08 00:00:00 2007-02-28 00:00:00 2007-11-26 00:00:00 2008-01-16 00:00:00 2008-01-21 00:00:00 2008-01-22 00:00:00 2008-02-11 00:00:00 2006-12-01 00:00:00 2007-10-09 00:00:00 2008-03-12 00:00:00 2005-12-11 00:00:00 2008-06-01 00:00:00 2008-08-12 00:00:00 2007-07-04 00:00:00 2009-01-10 00:00:00 2008-10-29 00:00:00 2008-11-01 00:00:00 2008-12-05 00:00:00 2008-12-12 00:00:00 2008-08-25 00:00:00 2008-12-19 00:00:00 2008-12-24 00:00:00 2008-12-29 00:00:00 2009-01-04 00:00:00 2008-01-01 00:00:00 2009-03-09 00:00:00 2009-02-09 00:00:00 2009-02-19 00:00:00 2009-03-27 00:00:00 2009-06-15 00:00:00 2009-06-19 00:00:00 2009-02-01 00:00:00 2009-08-01 00:00:00 2009-09-21 00:00:00 2009-09-01 00:00:00 2009-10-18 00:00:00 2009-11-23 00:00:00 2009-12-02 00:00:00 2006-03-09 00:00:00 2009-12-25 00:00:00 2009-12-22 00:00:00 2009-12-28 00:00:00 2010-01-04 00:00:00 2010-01-08 00:00:00 2010-01-30 00:00:00 2010-02-03 00:00:00 2010-02-10 00:00:00 2010-03-02 00:00:00 2011-09-08 00:00:00 2010-03-29 00:00:00 2010-03-31 00:00:00 2010-12-01 00:00:00 2010-04-13 00:00:00 2010-04-28 00:00:00 2010-05-12 00:00:00 2010-06-02 00:00:00 2010-06-14 00:00:00 2010-07-12 00:00:00 2010-07-25 00:00:00 2011-06-20 00:00:00 2011-09-28 00:00:00 2011-11-19 00:00:00 2009-04-08 00:00:00 2010-09-25 00:00:00 2010-10-02 00:00:00 2010-10-15 00:00:00 2010-11-19 00:00:00 2010-11-20 00:00:00 2010-11-30 00:00:00 2010-12-28 00:00:00 2010-12-15 00:00:00 2011-01-05 00:00:00 2011-01-08 00:00:00 2011-01-24 00:00:00 2011-02-10 00:00:00 2011-02-14 00:00:00 2011-03-31 00:00:00 2011-04-05 00:00:00 2011-04-13 00:00:00 2011-04-01 00:00:00 2011-04-26 00:00:00 2011-04-29 00:00:00 2011-05-12 00:00:00 2011-06-02 00:00:00 2011-06-13 00:00:00 2009-12-13 00:00:00 2009-05-25 00:00:00 2008-08-01 00:00:00 2011-07-25 00:00:00 2011-09-06 00:00:00 2011-09-16 00:00:00 2011-08-19 00:00:00 2013-01-17 00:00:00 2012-01-21 00:00:00 2012-01-29 00:00:00 2012-02-20 00:00:00 2012-04-18 00:00:00 2012-05-07 00:00:00 2012-05-11 00:00:00 2012-05-24 00:00:00 2012-07-25 00:00:00 2012-08-16 00:00:00 2012-08-24 00:00:00 2012-08-27 00:00:00 2012-06-08 00:00:00 2012-06-15 00:00:00 2012-08-31 00:00:00 2012-09-27 00:00:00 2012-04-10 00:00:00 2012-05-10 00:00:00 2012-06-25 00:00:00 2012-12-24 00:00:00 2009-05-15 00:00:00 2012-09-26 00:00:00 2012-04-23 00:00:00 2013-02-04 00:00:00 2012-12-01 00:00:00 2013-02-16 00:00:00 2013-03-13 00:00:00 2012-01-01 00:00:00 2013-02-23 00:00:00 2014-04-11 00:00:00 2012-11-01 00:00:00 2013-04-15 00:00:00 2013-04-01 00:00:00 2013-05-15 00:00:00 2013-01-08 00:00:00 2013-07-24 00:00:00 2013-08-22 00:00:00 2012-10-02 00:00:00 2013-07-05 00:00:00 2011-07-12 00:00:00 2013-09-18 00:00:00 2013-08-21 00:00:00 2013-09-30 00:00:00 2014-01-08 00:00:00 2014-01-28 00:00:00 2014-02-17 00:00:00 2013-11-26 00:00:00 2014-03-01 00:00:00 2014-04-23 00:00:00 2014-02-07 00:00:00 2014-05-01 00:00:00 2014-08-01 00:00:00 2014-05-19 00:00:00 2014-05-20 00:00:00 2014-05-12 00:00:00 2014-03-19 00:00:00

        # [smoking]  Len: 211(208) 1.0 0.0 nan
        # patient_csv[patient_csv['smoking'].isnull()][['case_no', 'name']].to_excel(u'for_hospital/是否吸烟缺失.xls', encoding='UTF-8')
        patient_csv['smoking'] = patient_csv['smoking'].fillna(2)  # 暂时填充为2
        patient_csv[patient_csv['smoking'] == 2] = 0               # 填充为实际值

        # [education]  Len: 211(132) 1.0 nan 0.0 2.0 3.0
        # patient_csv[patient_csv['education'].isnull()][['case_no', 'name']].to_excel(u'for_hospital/教育程度缺失.xls', encoding='UTF-8')
        # patient_csv['education'].fillna(4, inplace=True)  # 暂时填充为4

        # [payment]  Len: 211(210) 0.0 3.0 6.0 4.0 5.0 nan 2.0 1.0
        # patient_csv[patient_csv['payment'].isnull()][['case_no', 'name']].to_excel(u'for_hospital/支付方式缺失.xls', encoding='UTF-8')
        patient_csv['payment'].fillna(7, inplace=True)  # 暂时填充为7

        # [marital]  Len: 211(208) 0.0 1.0 nan 4.0 3.0
        # patient_csv[patient_csv['marital'].isnull()][['case_no', 'name']].to_excel(u'for_hospital/婚姻状态缺失.xls', encoding='UTF-8')
        patient_csv['marital'].fillna(5, inplace=True)  # 暂时填充为5

        # [alcohol]  Len: 211(208) 饮酒30年，已戒3年 0 透前偶有饮酒，十几度，半斤 透前白酒45度，500g，每餐 数十余年，1斤白酒/天，已戒 透前偶饮啤酒500g nan 偶有喝酒 米酒3两/天，已戒酒5年 每日2两白酒，10年 喝酒20余年，每日约500g白酒或啤酒，已戒30余年 曾嗜酒，30度米酒200g/次*3次/日*30年，已戒2年 既往喝酒，不详，已戒酒1年 既往喝酒，不详，已戒酒10余年 既往喝啤酒5年，1-2瓶/天，已戒20年 每天250g 30度 透前饮酒250-500g，1周2次，10度 间断喝酒 透前30度 100-150g，1周2次 喝酒20年，各种酒，已戒酒6年 既往喝酒，量不详，已戒酒6年 喝酒20年余，每天约4两白酒，已戒酒1年余 啤酒或白酒10-40度，50-100g，每月1-2次 透前30度白酒，量不等 白酒60度，250-500g，每月1-2次 既往饮酒多年，已戒酒8年 白酒45度，200-500g，1月10余次 白酒40度，150g，每餐 白酒50度，500g，1-2月1次 白酒40度，250g以上，每周2-3次 啤酒12度，2000g，每3-4天 白酒30度，500g，每天 白酒50度，2000g，每2月 既往1年几次，啤酒1杯 30度鸿茅药酒半两每天啊 白酒40度，250g，每餐 既往米酒30度每天，斤半 既往3-4瓶啤酒每天
        # 0 -> 不喝, 非0 -> 喝过（无论是否戒酒）,
        alcohol = patient_csv['alcohol'].copy()
        alcohol.fillna('2', inplace=True)                                               # 暂时填充为2
        alcohol[(patient_csv['alcohol'] != '0')&(patient_csv['alcohol'] != '2')] = '1'  # 补充为喝过的
        patient_csv['alcohol'] = alcohol

        # 均值填充
        patient_csv['spKtV'].fillna(patient_csv['spKtV'].mean(), inplace=True)
        patient_csv['RETHb'].fillna(patient_csv['RETHb'].mean(), inplace=True)
        patient_csv['ALT'].fillna(patient_csv['ALT'].mean(), inplace=True)
        patient_csv['AST'].fillna(patient_csv['AST'].mean(), inplace=True)
        patient_csv['ALB'].fillna(patient_csv['ALB'].mean(), inplace=True)
        patient_csv['CRP'].fillna(patient_csv['CRP'].mean(), inplace=True)
        patient_csv['Fe'].fillna(patient_csv['Fe'].mean(), inplace=True)
        patient_csv['UIBC'].fillna(patient_csv['UIBC'].mean(), inplace=True)
        patient_csv['TIBC'].fillna(patient_csv['TIBC'].mean(), inplace=True)
        # 由于LGalldata数据缺失，无TSAT
        # patient_csv['TSAT'].fillna(patient_csv['TSAT'].mean(), inplace=True)
        patient_csv['iPTH'].fillna(patient_csv['iPTH'].mean(), inplace=True)
        patient_csv['CHOL'].fillna(patient_csv['CHOL'].mean(), inplace=True)
        patient_csv['TRIG'].fillna(patient_csv['TRIG'].mean(), inplace=True)
        patient_csv['HDL'].fillna(patient_csv['HDL'].mean(), inplace=True)
        patient_csv['LDL'].fillna(patient_csv['LDL'].mean(), inplace=True)
        patient_csv['Lpa'].fillna(patient_csv['Lpa'].mean(), inplace=True)
        patient_csv['postBUN'].fillna(patient_csv['postBUN'].mean(), inplace=True)

        # 规整
        anticoagulant = patient_csv['anticoagulant'].copy()
        anticoagulant[anticoagulant == 2] = 1
        patient_csv['anticoagulant'] = anticoagulant
        EPOdose = patient_csv['EPOdose'].copy()
        EPOdose[patient_csv['EPO'] == 0] = 0
        patient_csv['EPOdose'] = EPOdose

        # 增加一列表示开始透析的年龄
        patient_csv['age_true'] = (patient_csv['dateSt'] - patient_csv['birth']).map(lambda x: x.days / 365.0)
        del patient_csv['dateSt']
        del patient_csv['birth']

        return patient_csv